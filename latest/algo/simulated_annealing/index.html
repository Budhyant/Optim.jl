<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="JuliaNLSolvers">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Simulated Annealing - Optim.jl</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Simulated Annealing", url: "#simulated-annealing", children: [
              {title: "Constructor", url: "#constructor" },
              {title: "Description", url: "#description" },
              {title: "Example", url: "#example" },
              {title: "References", url: "#references" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../assets/mathjaxhelper.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../samin/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../samin/" class="btn btn-xs btn-link">
        Simulated Annealing w/ bounds
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../nelder_mead/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../nelder_mead/" class="btn btn-xs btn-link">
        Nelder Mead
      </a>
    </div>
    
  </div>

    

    <p><a id='Simulated-Annealing-1'></a></p>
<h1 id="simulated-annealing">Simulated Annealing</h1>
<p><a id='Constructor-1'></a></p>
<h2 id="constructor">Constructor</h2>
<div class="codehilite"><pre><span></span><span class="n">SimulatedAnnealing</span><span class="p">(;</span> <span class="n">neighbor</span> <span class="o">=</span> <span class="n">default_neighbor!</span><span class="p">,</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="n">default_temperature</span><span class="p">,</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">kirkpatrick</span><span class="p">)</span>
</pre></div>


<p>The constructor takes three keywords:</p>
<ul>
<li><code>neighbor = a!(x_proposed, x_current)</code>, a mutating function of the current x, and the proposed x</li>
<li><code>T = b(iteration)</code>, a function of the current iteration that returns a temperature</li>
<li><code>p = c(f_proposal, f_current, T)</code>, a function of the current temperature, current function value and proposed function value that returns an acceptance probability</li>
</ul>
<p><a id='Description-1'></a></p>
<h2 id="description">Description</h2>
<p>Simulated Annealing is a derivative free method for optimization. It is based on the Metropolis-Hastings algorithm that was originally used to generate samples from a thermodynamics system, and is often used to generate draws from a posterior when doing Bayesian inference. As such, it is a probabilistic method for finding the minimum of a function, often over a quite large domains. For the historical reasons given above, the algorithm uses terms such as cooling, temperature, and acceptance probabilities.</p>
<p>As the constructor shows, a simulated annealing implementation is characterized by a temperature, a neighbor function, and an acceptance probability. The temperature controls how volatile the changes in minimizer candidates are allowed to be, as it enters the acceptance probability. For example, the original Kirkpatrick et al. acceptance probability function can be written as follows</p>
<div class="codehilite"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">f_proposal</span><span class="p">,</span> <span class="n">f_current</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">f_proposal</span> <span class="o">-</span> <span class="n">f_current</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
</pre></div>


<p>A high temperature makes it more likely that a draw is accepted, by pushing acceptance probability to 1. As in the Metropolis-Hastings algorithm, we always accept a smaller function value, but we also sometimes accept a larger value. As the temperature decreases, we're more and more likely to only accept candidate <code>x</code>'s that lowers the function value. To obtain a new <code>f_proposal</code>, we need a neighbor function. A simple neighbor function adds a standard normal draw to each dimension of <code>x</code></p>
<div class="codehilite"><pre><span></span><span class="k">function</span> <span class="n">neighbor!</span><span class="p">(</span><span class="n">x_proposal</span><span class="o">::</span><span class="kt">Array</span><span class="p">,</span> <span class="n">x</span><span class="o">::</span><span class="kt">Array</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="kp">in</span> <span class="n">eachindex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x_proposal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">randn</span><span class="p">()</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>


<p>As we see, it is not really possible to disentangle the role of the different components of the algorithm. For example, both the functional form of the acceptance function, the temperature and (indirectly) the neighbor function determine if the next draw of <code>x</code> is accepted or not.</p>
<p>The current implementation of Simulated Annealing is very rough.  It lacks quite a few features which are normally part of a proper SA implementation. A better implementation is under way, see <a href="https://github.com/JuliaNLSolvers/Optim.jl/issues/200">this issue</a>.</p>
<p><a id='Example-1'></a></p>
<h2 id="example">Example</h2>
<p><a id='References-1'></a></p>
<h2 id="references">References</h2>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../samin/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../samin/" class="btn btn-xs btn-link">
        Simulated Annealing w/ bounds
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../nelder_mead/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../nelder_mead/" class="btn btn-xs btn-link">
        Nelder Mead
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>