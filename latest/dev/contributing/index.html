<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="JuliaNLSolvers">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Contributing - Optim.jl</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Notes for contributing", url: "#notes-for-contributing", children: [
              {title: "Things to consider", url: "#things-to-consider" },
              {title: "Adding a solver", url: "#adding-a-solver" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../assets/mathjaxhelper.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../LICENSE/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../LICENSE/" class="btn btn-xs btn-link">
        License
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../algo/manifolds/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../algo/manifolds/" class="btn btn-xs btn-link">
        Manifolds
      </a>
    </div>
    
  </div>

    

    <p><a id='Notes-for-contributing-1'></a></p>
<h2 id="notes-for-contributing">Notes for contributing</h2>
<p>We are always happy to get help from people who normally do not contribute to the package. However, to make the process run smoothly, we ask you to read this page before creating your pull request. That way it is more probable that your changes will be incorporated, and in the end it will mean less work for everyone.</p>
<p><a id='Things-to-consider-1'></a></p>
<h3 id="things-to-consider">Things to consider</h3>
<p>When proposing a change to <code>Optim.jl</code>, there are a few things to consider. If you're in doubt feel free to reach out. A simple way to get in touch, is to join our <a href="https://gitter.im/JuliaNLSolvers/Optim.jl">gitter channel</a>.</p>
<p>Before submitting a pull request, please consider the following bullets:</p>
<ul>
<li>Did you remember to provide tests for your changes? If not, please do so, or ask for help.</li>
<li>Did your change add new functionality? Remember to add a section in the documentation.</li>
<li>Did you change existing code in a breaking way? Then remember to use Julia's deprecation tools to help users migrate to the new syntax.</li>
<li>Add a note in the NEWS.md file, so we can keep track of changes between versions.</li>
</ul>
<p><a id='Adding-a-solver-1'></a></p>
<h3 id="adding-a-solver">Adding a solver</h3>
<p>If you're contributing a new solver, you shouldn't need to touch any of the code in <code>src/optimize.jl</code>. You should rather add a file named (<code>solver</code> is the name of the solver) <code>solver.jl</code> in <code>src</code>, and make sure that you define an <code>Optimizer</code> subtype <code>struct Solver &lt;: Optimizer end</code> with appropriate fields, a default constructor with a keyword for each field, a state type that holds all variables that are (re)used throughout the iterative procedure, an <code>initial_state</code> that initializes such a state, and  an <code>update!</code> method that does the actual work. Say you want to contribute a solver called <code>Minim</code>, then your <code>src/minim.jl</code> file would look something like</p>
<div class="codehilite"><pre><span></span><span class="nx">struct</span> <span class="nx">Minim</span><span class="p">{</span><span class="nx">IF</span><span class="p">,</span> <span class="nx">F</span><span class="o">&lt;:</span><span class="nb">Function</span><span class="p">,</span> <span class="nx">T</span><span class="p">}</span> <span class="o">&lt;:</span> <span class="nx">Optimizer</span>
    <span class="nx">alphaguess</span><span class="o">!::</span><span class="nx">IF</span>
    <span class="nx">linesearch</span><span class="o">!::</span><span class="nx">F</span>
    <span class="nx">minim_parameter</span><span class="o">::</span><span class="nx">T</span>
<span class="nx">end</span>

<span class="nx">Minim</span><span class="p">(;</span> <span class="nx">alphaguess</span> <span class="o">=</span> <span class="nx">LineSearches</span><span class="p">.</span><span class="nx">InitialStatic</span><span class="p">(),</span> <span class="nx">linesearch</span> <span class="o">=</span> <span class="nx">LineSearches</span><span class="p">.</span><span class="nx">HagerZhang</span><span class="p">(),</span> <span class="nx">minim_parameter</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">=</span>
  <span class="nx">Minim</span><span class="p">(</span><span class="nx">linesearch</span><span class="p">,</span> <span class="nx">minim_parameter</span><span class="p">)</span>

<span class="nx">type</span> <span class="nx">MinimState</span><span class="p">{</span><span class="nx">T</span><span class="p">,</span><span class="nx">N</span><span class="p">,</span><span class="nx">G</span><span class="p">}</span>
  <span class="nx">x</span><span class="o">::</span><span class="nx">AbstractArray</span><span class="p">{</span><span class="nx">T</span><span class="p">,</span><span class="nx">N</span><span class="p">}</span>
  <span class="nx">x_previous</span><span class="o">::</span><span class="nx">AbstractArray</span><span class="p">{</span><span class="nx">T</span><span class="p">,</span><span class="nx">N</span><span class="p">}</span>
  <span class="nx">f_x_previous</span><span class="o">::</span><span class="nx">T</span>
  <span class="nx">s</span><span class="o">::</span><span class="nx">AbstractArray</span><span class="p">{</span><span class="nx">T</span><span class="p">,</span><span class="nx">N</span><span class="p">}</span>
  <span class="kd">@add_linesearch_fields</span><span class="p">()</span>
<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">initial_state</span><span class="p">(</span><span class="nx">method</span><span class="o">::</span><span class="nx">Minim</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">initial_x</span><span class="p">)</span>
<span class="err">#</span> <span class="nx">prepare</span> <span class="nx">cache</span> <span class="nx">variables</span> <span class="nx">etc</span> <span class="nx">here</span>

<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">update</span><span class="o">!</span><span class="p">{</span><span class="nx">T</span><span class="p">}(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">state</span><span class="o">::</span><span class="nx">MinimState</span><span class="p">{</span><span class="nx">T</span><span class="p">},</span> <span class="nx">method</span><span class="o">::</span><span class="nx">Minim</span><span class="p">)</span>
    <span class="err">#</span> <span class="nx">code</span> <span class="k">for</span> <span class="nx">Minim</span> <span class="nx">here</span>
    <span class="kc">false</span> <span class="err">#</span> <span class="nx">should</span> <span class="nx">the</span> <span class="nx">procedure</span> <span class="nx">force</span> <span class="nx">quit</span><span class="o">?</span>
<span class="nx">end</span>
</pre></div>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../LICENSE/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../LICENSE/" class="btn btn-xs btn-link">
        License
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../algo/manifolds/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../algo/manifolds/" class="btn btn-xs btn-link">
        Manifolds
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>